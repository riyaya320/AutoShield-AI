
*** Cleaning up old Mininet state

*** Loading PPO model: models/ppo/final_model.zip

*** Building & starting Mininet
*** Creating network
*** Adding hosts:
fw hatk1 hatk2 hleg1 hleg2 srv 
*** Adding switches:
s1 s2 
*** Adding links:
(50.00Mbit 2ms delay) *** Error: Warning: sch_htb: quantum of class 50001 is big. Consider r2q change.
(50.00Mbit 2ms delay) *** Error: Warning: sch_htb: quantum of class 50001 is big. Consider r2q change.
(fw, s2) (100.00Mbit 1ms delay) *** Error: Warning: sch_htb: quantum of class 50001 is big. Consider r2q change.
(100.00Mbit 1ms delay) *** Error: Warning: sch_htb: quantum of class 50001 is big. Consider r2q change.
(hatk1, s1) (100.00Mbit 1ms delay) *** Error: Warning: sch_htb: quantum of class 50001 is big. Consider r2q change.
(100.00Mbit 1ms delay) *** Error: Warning: sch_htb: quantum of class 50001 is big. Consider r2q change.
(hatk2, s1) (100.00Mbit 1ms delay) *** Error: Warning: sch_htb: quantum of class 50001 is big. Consider r2q change.
(100.00Mbit 1ms delay) *** Error: Warning: sch_htb: quantum of class 50001 is big. Consider r2q change.
(hleg1, s1) (100.00Mbit 1ms delay) *** Error: Warning: sch_htb: quantum of class 50001 is big. Consider r2q change.
(100.00Mbit 1ms delay) *** Error: Warning: sch_htb: quantum of class 50001 is big. Consider r2q change.
(hleg2, s1) (100.00Mbit 1ms delay) *** Error: Warning: sch_htb: quantum of class 50001 is big. Consider r2q change.
(100.00Mbit 1ms delay) *** Error: Warning: sch_htb: quantum of class 50001 is big. Consider r2q change.
(s1, fw) (50.00Mbit 2ms delay) *** Error: Warning: sch_htb: quantum of class 50001 is big. Consider r2q change.
(50.00Mbit 2ms delay) *** Error: Warning: sch_htb: quantum of class 50001 is big. Consider r2q change.
(s2, srv) 
*** Configuring hosts
fw hatk1 hatk2 hleg1 hleg2 srv 
*** Starting controller

*** Starting 2 switches
s1 s2 ...(100.00Mbit 1ms delay) *** Error: Warning: sch_htb: quantum of class 50001 is big. Consider r2q change.
(100.00Mbit 1ms delay) *** Error: Warning: sch_htb: quantum of class 50001 is big. Consider r2q change.
(100.00Mbit 1ms delay) *** Error: Warning: sch_htb: quantum of class 50001 is big. Consider r2q change.
(100.00Mbit 1ms delay) *** Error: Warning: sch_htb: quantum of class 50001 is big. Consider r2q change.
(100.00Mbit 1ms delay) *** Error: Warning: sch_htb: quantum of class 50001 is big. Consider r2q change.
(50.00Mbit 2ms delay) *** Error: Warning: sch_htb: quantum of class 50001 is big. Consider r2q change.
(50.00Mbit 2ms delay) *** Error: Warning: sch_htb: quantum of class 50001 is big. Consider r2q change.


 *** DEBUG: MNCOUNT inside fw namespace
Chain MNCOUNT (1 references)
    pkts      bytes target     prot opt in     out     source               destination         
       0        0 MARK       all  --  *      *       0.0.0.0/0            0.0.0.0/0            /* MN_TOTAL */ MARK set 0x1
       0        0 MARK       tcp  --  *      *       0.0.0.0/0            0.0.0.0/0            /* MN_TCP */ MARK set 0x1
       0        0 MARK       udp  --  *      *       0.0.0.0/0            0.0.0.0/0            /* MN_UDP */ MARK set 0x1
       0        0 MARK       icmp --  *      *       0.0.0.0/0            0.0.0.0/0            /* MN_ICMP */ MARK set 0x1
       0        0 MARK       tcp  --  *      *       0.0.0.0/0            0.0.0.0/0            tcp flags:0x02/0x02 /* MN_SYN */ MARK set 0x1
       0        0 MARK       tcp  --  *      *       0.0.0.0/0            0.0.0.0/0            tcp flags:0x10/0x10 /* MN_ACK */ MARK set 0x1


*** DEBUG: fw interfaces after IP assignment
[1;36mlo               [0mUNKNOWN        [1;35m127.0.0.1[0m/8 [1;94m::1[0m/128 
[1;36mfw-eth1@if184    [0m[1;32mUP             [0m[1;35m10.0.2.1[0m/24 
[1;36mfw-eth0@if189    [0m[1;32mUP             [0m[1;35m10.0.1.1[0m/24 

*** fw_lan=fw-eth0, fw_wan=fw-eth1

*** Starting iperf3 server on srv

*** DEBUG: MNCOUNT rules inside fw namespace
-P PREROUTING ACCEPT
-N MNCOUNT
-A PREROUTING -j MNCOUNT
-A MNCOUNT -m comment --comment MN_TOTAL -j MARK --set-xmark 0x1/0xffffffff
-A MNCOUNT -p tcp -m comment --comment MN_TCP -j MARK --set-xmark 0x1/0xffffffff
-A MNCOUNT -p udp -m comment --comment MN_UDP -j MARK --set-xmark 0x1/0xffffffff
-A MNCOUNT -p icmp -m comment --comment MN_ICMP -j MARK --set-xmark 0x1/0xffffffff
-A MNCOUNT -p tcp -m tcp --tcp-flags SYN,ACK SYN -m comment --comment MN_SYN -j MARK --set-xmark 0x1/0xffffffff
-A MNCOUNT -p tcp -m tcp --tcp-flags SYN,ACK ACK -m comment --comment MN_ACK -j MARK --set-xmark 0x1/0xffffffff

Chain MNCOUNT (1 references)
    pkts      bytes target     prot opt in     out     source               destination         
       7    26428 MARK       all  --  *      *       0.0.0.0/0            0.0.0.0/0            /* MN_TOTAL */ MARK set 0x1
       7    26428 MARK       tcp  --  *      *       0.0.0.0/0            0.0.0.0/0            /* MN_TCP */ MARK set 0x1
       0        0 MARK       udp  --  *      *       0.0.0.0/0            0.0.0.0/0            /* MN_UDP */ MARK set 0x1
       0        0 MARK       icmp --  *      *       0.0.0.0/0            0.0.0.0/0            /* MN_ICMP */ MARK set 0x1
       0        0 MARK       tcp  --  *      *       0.0.0.0/0            0.0.0.0/0            tcp flags:0x12/0x02 /* MN_SYN */ MARK set 0x1
       1     8740 MARK       tcp  --  *      *       0.0.0.0/0            0.0.0.0/0            tcp flags:0x12/0x10 /* MN_ACK */ MARK set 0x1


*** Entering Mininet CLI (LIVE DEMO)
*** Start attacks manually from hatk1/hatk2, and watch PPO actions print above.

*** Starting CLI:

*** LIVE MODE: PPO loop started. Start attacks manually in Mininet CLI.
mininet> [t=0.1s] action=1 (RATE_LIMIT_TCP) lat=20.4ms loss=0.00 syn/ack=0.00
[t=1.1s] action=7 (GLOBAL_RATE_LIMIT) lat=10.1ms loss=0.00 syn/ack=0.00
[t=2.1s] action=1 (RATE_LIMIT_TCP) lat=17.5ms loss=0.00 syn/ack=0.00
[t=3.1s] action=1 (RATE_LIMIT_TCP) lat=10.1ms loss=0.00 syn/ack=0.00
[t=4.1s] action=1 (RATE_LIMIT_TCP) lat=10.1ms loss=0.00 syn/ack=0.00
[t=5.1s] action=0 (ALLOW_ALL) lat=10.1ms loss=0.00 syn/ack=0.00
[t=6.1s] action=1 (RATE_LIMIT_TCP) lat=17.4ms loss=0.00 syn/ack=0.00
[t=7.1s] action=1 (RATE_LIMIT_TCP) lat=10.1ms loss=0.00 syn/ack=0.00
[t=8.1s] action=1 (RATE_LIMIT_TCP) lat=10.1ms loss=0.00 syn/ack=0.00
[t=9.2s] action=1 (RATE_LIMIT_TCP) lat=10.3ms loss=0.00 syn/ack=0.00
[t=10.1s] action=1 (RATE_LIMIT_TCP) lat=10.1ms loss=0.00 syn/ack=0.00
[t=11.1s] action=1 (RATE_LIMIT_TCP) lat=10.1ms loss=0.00 syn/ack=0.00
[t=12.1s] action=1 (RATE_LIMIT_TCP) lat=10.1ms loss=0.00 syn/ack=0.00
[t=13.1s] action=1 (RATE_LIMIT_TCP) lat=10.1ms loss=0.00 syn/ack=0.00
[t=14.1s] action=0 (ALLOW_ALL) lat=10.1ms loss=0.00 syn/ack=0.00
[t=15.1s] action=1 (RATE_LIMIT_TCP) lat=10.1ms loss=0.00 syn/ack=0.00
[t=16.2s] action=1 (RATE_LIMIT_TCP) lat=10.2ms loss=0.00 syn/ack=0.00
[t=17.1s] action=1 (RATE_LIMIT_TCP) lat=10.1ms loss=0.00 syn/ack=0.00
[t=18.1s] action=1 (RATE_LIMIT_TCP) lat=10.3ms loss=0.00 syn/ack=0.00
[t=19.1s] action=1 (RATE_LIMIT_TCP) lat=10.1ms loss=0.00 syn/ack=0.00
[t=20.1s] action=7 (GLOBAL_RATE_LIMIT) lat=10.1ms loss=0.00 syn/ack=0.00
[t=21.2s] action=1 (RATE_LIMIT_TCP) lat=25.8ms loss=0.00 syn/ack=0.00
[t=22.1s] action=0 (ALLOW_ALL) lat=10.1ms loss=0.00 syn/ack=0.00
[t=23.1s] action=7 (GLOBAL_RATE_LIMIT) lat=16.9ms loss=0.00 syn/ack=0.00
[t=24.1s] action=1 (RATE_LIMIT_TCP) lat=10.1ms loss=0.00 syn/ack=0.00
[t=25.1s] action=1 (RATE_LIMIT_TCP) lat=10.1ms loss=0.00 syn/ack=0.00
[t=26.1s] action=1 (RATE_LIMIT_TCP) lat=10.1ms loss=0.00 syn/ack=0.00
[t=27.1s] action=1 (RATE_LIMIT_TCP) lat=10.1ms loss=0.00 syn/ack=0.00
[t=28.1s] action=1 (RATE_LIMIT_TCP) lat=10.1ms loss=0.00 syn/ack=0.00
[t=29.1s] action=1 (RATE_LIMIT_TCP) lat=10.1ms loss=0.00 syn/ack=0.00
[t=30.1s] action=1 (RATE_LIMIT_TCP) lat=10.1ms loss=0.00 syn/ack=0.00
[t=31.1s] action=7 (GLOBAL_RATE_LIMIT) lat=10.2ms loss=0.00 syn/ack=0.00
[t=32.2s] action=1 (RATE_LIMIT_TCP) lat=21.0ms loss=0.00 syn/ack=0.00
[t=33.1s] action=1 (RATE_LIMIT_TCP) lat=10.1ms loss=0.00 syn/ack=0.00
[t=34.2s] action=7 (GLOBAL_RATE_LIMIT) lat=10.1ms loss=0.00 syn/ack=0.00
[t=35.2s] action=1 (RATE_LIMIT_TCP) lat=34.0ms loss=0.00 syn/ack=0.00
[t=36.1s] action=1 (RATE_LIMIT_TCP) lat=10.1ms loss=0.00 syn/ack=0.00
[t=37.1s] action=1 (RATE_LIMIT_TCP) lat=10.1ms loss=0.00 syn/ack=0.00
[t=38.1s] action=1 (RATE_LIMIT_TCP) lat=10.1ms loss=0.00 syn/ack=0.00
[t=39.1s] action=7 (GLOBAL_RATE_LIMIT) lat=10.2ms loss=0.00 syn/ack=0.00
[t=40.1s] action=0 (ALLOW_ALL) lat=21.1ms loss=0.00 syn/ack=0.00
[t=41.1s] action=1 (RATE_LIMIT_TCP) lat=18.7ms loss=0.00 syn/ack=0.00
[t=42.1s] action=1 (RATE_LIMIT_TCP) lat=10.1ms loss=0.00 syn/ack=0.00
[t=43.2s] action=1 (RATE_LIMIT_TCP) lat=10.1ms loss=0.00 syn/ack=0.00
[t=44.1s] action=0 (ALLOW_ALL) lat=10.1ms loss=0.00 syn/ack=0.00
[t=45.2s] action=0 (ALLOW_ALL) lat=44.6ms loss=0.00 syn/ack=0.00
[t=46.2s] action=7 (GLOBAL_RATE_LIMIT) lat=95.9ms loss=0.00 syn/ack=0.00
[t=47.1s] action=7 (GLOBAL_RATE_LIMIT) lat=11.1ms loss=0.00 syn/ack=0.00
[t=48.2s] action=1 (RATE_LIMIT_TCP) lat=22.1ms loss=0.00 syn/ack=0.00
[t=49.1s] action=1 (RATE_LIMIT_TCP) lat=10.1ms loss=0.00 syn/ack=0.00
[t=50.2s] action=1 (RATE_LIMIT_TCP) lat=10.1ms loss=0.00 syn/ack=0.00
[t=51.2s] action=1 (RATE_LIMIT_TCP) lat=10.1ms loss=0.00 syn/ack=0.00
[t=52.2s] action=1 (RATE_LIMIT_TCP) lat=10.3ms loss=0.00 syn/ack=0.00
[t=53.2s] action=1 (RATE_LIMIT_TCP) lat=10.1ms loss=0.00 syn/ack=0.00
[t=54.2s] action=1 (RATE_LIMIT_TCP) lat=10.2ms loss=0.00 syn/ack=0.00
[t=55.1s] action=0 (ALLOW_ALL) lat=10.1ms loss=0.00 syn/ack=0.00
[t=56.2s] action=1 (RATE_LIMIT_TCP) lat=19.7ms loss=0.00 syn/ack=0.00

Interrupt
mininet> [t=57.1s] action=1 (RATE_LIMIT_TCP) lat=10.1ms loss=0.00 syn/ack=0.00
[t=58.2s] action=1 (RATE_LIMIT_TCP) lat=10.1ms loss=0.00 syn/ack=0.00

Interrupt
mininet> [t=59.1s] action=0 (ALLOW_ALL) lat=10.4ms loss=0.00 syn/ack=0.00
[t=60.2s] action=1 (RATE_LIMIT_TCP) lat=21.9ms loss=0.00 syn/ack=0.00
[t=61.1s] action=7 (GLOBAL_RATE_LIMIT) lat=10.1ms loss=0.00 syn/ack=0.00
[t=62.1s] action=7 (GLOBAL_RATE_LIMIT) lat=25.5ms loss=0.00 syn/ack=0.00
[t=63.2s] action=1 (RATE_LIMIT_TCP) lat=17.0ms loss=0.00 syn/ack=0.00

*** Mininet CLI exited. Stopping...
*** Stopping 0 controllers

*** Stopping 7 links
.......
*** Stopping 2 switches
s1 s2 
*** Stopping 6 hosts
fw hatk1 hatk2 hleg1 hleg2 srv 
*** Done
